{
  "hash": "88b430dcaa9c9e130165a3116e692d0e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Multicollinearity is not a disease\"\ndate: \"2026-02-21\"\nauthor: \"Juan Tellez\"\nformat: html\ntoc: true\ncategories: [R, causality]\ndraft: true\n---\n\n\n\n\n\n## Introduction\n\n\nMany econometrics textbooks have a section on \"multicollinearity\" that treats it as a diagnosable problem. They present VIF statistics, tolerance thresholds, and condition numbers, leaving students with the impression that high correlation among regressors is a kind of disease that needs treatment. Some even suggest dropping variables or combining them via PCA.\n\nWooldridge pushes back on this in *Introductory Econometrics*. He argues that multicollinearity is not a violation of any OLS assumption and that textbooks which \"test\" for it or try to \"solve\" it are misleading. As he puts it, multicollinearity is essentially a small-sample problem: it means you don't have enough variation in your data to precisely estimate what you want to estimate. Blanchard makes the point even more bluntly: \"multicollinearity is God's will, not a problem with OLS.\"\n\nThis post uses a simulation to build intuition for what multicollinearity actually is and why Wooldridge and Blanchard are right.\n\n\n## Setup: press freedom and FDI\n\n\nSuppose we want to estimate the effect of press freedom on foreign direct investment (FDI). We believe that regime type — whether a country is a democracy or not — confounds this relationship: democracies tend to have freer presses *and* tend to attract more FDI. So we control for democracy.\n\nHere is the data-generating process. The true effect of press freedom on FDI is $\\beta = 0.5$: for each unit increase in press freedom, FDI increases by half a unit. Democracy independently boosts both press freedom and FDI:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nset.seed(42)\nn <- 200\n\n# democracy is binary\ndemocracy <- rbinom(n, 1, 0.4)\n\n# press freedom: democracies have higher and more variable press freedom\npress_freedom <- case_when(\n  democracy == 1 ~ rnorm(n, mean = 7, sd = 1.5),\n  democracy == 0 ~ rnorm(n, mean = 2, sd = 0.5)\n)\n\n# FDI: function of press freedom + democracy + noise\nbeta_true <- 0.5\nfdi <- beta_true * press_freedom + 3 * democracy + rnorm(n, sd = 2)\n\ndf <- tibble(democracy = factor(democracy, labels = c(\"Autocracy\", \"Democracy\")),\n             press_freedom, fdi)\n```\n:::\n\n\n\n## The data\n\n\nLet's look at what this data looks like:\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](multicollinearity-draft_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\nTwo things are clear. First, there is a strong positive relationship between press freedom and FDI. Second, democracies and autocracies occupy very different regions of the press freedom axis. Within autocracies, press freedom barely varies — it's almost always between 1 and 3.\n\nThis is the \"multicollinearity\": press freedom and democracy are highly correlated, so when we control for democracy, there isn't much variation left in press freedom to work with — especially within the autocracy group.\n\n\n## The naive and controlled estimates\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(estimatr)\nlibrary(modelsummary)\n\nmod_naive <- lm_robust(fdi ~ press_freedom, data = df)\nmod_controlled <- lm_robust(fdi ~ press_freedom + democracy, data = df)\n\nmodelsummary(list(\"No controls\" = mod_naive,\n                  \"Control for democracy\" = mod_controlled),\n             gof_map = \"nobs\", stars = TRUE)\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<!-- preamble start -->\n\n    <script src=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.js\"></script>\n\n    <script>\n      // Create table-specific functions using external factory\n      const tableFns_d4jmi219ryng9omcqgo8 = TinyTable.createTableFunctions(\"tinytable_d4jmi219ryng9omcqgo8\");\n      // tinytable span after\n      window.addEventListener('load', function () {\n          var cellsToStyle = [\n            // tinytable style arrays after\n          { positions: [ { i: '7', j: 2 }, { i: '7', j: 3 } ], css_id: 'tinytable_css_nbrz1b0bu09u2g3oa9f6',}, \n          { positions: [ { i: '6', j: 2 }, { i: '6', j: 3 } ], css_id: 'tinytable_css_imo2rfkquw8qy4ra7k34',}, \n          { positions: [ { i: '1', j: 2 }, { i: '2', j: 2 }, { i: '3', j: 2 }, { i: '4', j: 2 }, { i: '5', j: 2 }, { i: '1', j: 3 }, { i: '2', j: 3 }, { i: '3', j: 3 }, { i: '4', j: 3 }, { i: '5', j: 3 } ], css_id: 'tinytable_css_0epqhktawt9i57fg7aeu',}, \n          { positions: [ { i: '0', j: 2 }, { i: '0', j: 3 } ], css_id: 'tinytable_css_6fb5i17nkworow5izk00',}, \n          { positions: [ { i: '7', j: 1 } ], css_id: 'tinytable_css_m4kgy9rxl4nbepwrmdbh',}, \n          { positions: [ { i: '6', j: 1 } ], css_id: 'tinytable_css_99xaj1uo9vzemnoaix4i',}, \n          { positions: [ { i: '1', j: 1 }, { i: '2', j: 1 }, { i: '3', j: 1 }, { i: '4', j: 1 }, { i: '5', j: 1 } ], css_id: 'tinytable_css_91v2xrrt9oibhuh877y7',}, \n          { positions: [ { i: '0', j: 1 } ], css_id: 'tinytable_css_ricwb0iimqulcdj7d1dt',}, \n          ];\n\n          // Loop over the arrays to style the cells\n          cellsToStyle.forEach(function (group) {\n              group.positions.forEach(function (cell) {\n                  tableFns_d4jmi219ryng9omcqgo8.styleCell(cell.i, cell.j, group.css_id);\n              });\n          });\n      });\n    </script>\n\n    <link rel=\"stylesheet\" href=\"https://cdn.jsdelivr.net/gh/vincentarelbundock/tinytable@main/inst/tinytable.css\">\n    <style>\n    /* tinytable css entries after */\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_nbrz1b0bu09u2g3oa9f6, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_nbrz1b0bu09u2g3oa9f6 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_imo2rfkquw8qy4ra7k34, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_imo2rfkquw8qy4ra7k34 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_0epqhktawt9i57fg7aeu, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_0epqhktawt9i57fg7aeu { text-align: center }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_6fb5i17nkworow5izk00, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_6fb5i17nkworow5izk00 {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: center }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_m4kgy9rxl4nbepwrmdbh, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_m4kgy9rxl4nbepwrmdbh {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.1em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_99xaj1uo9vzemnoaix4i, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_99xaj1uo9vzemnoaix4i {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 0; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_91v2xrrt9oibhuh877y7, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_91v2xrrt9oibhuh877y7 { text-align: left }\n    #tinytable_d4jmi219ryng9omcqgo8 td.tinytable_css_ricwb0iimqulcdj7d1dt, #tinytable_d4jmi219ryng9omcqgo8 th.tinytable_css_ricwb0iimqulcdj7d1dt {  position: relative; --border-bottom: 1; --border-left: 0; --border-right: 0; --border-top: 1; --line-color-bottom: black; --line-color-left: black; --line-color-right: black; --line-color-top: black; --line-width-bottom: 0.05em; --line-width-left: 0.1em; --line-width-right: 0.1em; --line-width-top: 0.1em; --trim-bottom-left: 0%; --trim-bottom-right: 0%; --trim-left-bottom: 0%; --trim-left-top: 0%; --trim-right-bottom: 0%; --trim-right-top: 0%; --trim-top-left: 0%; --trim-top-right: 0%; ; text-align: left }\n    </style>\n    <div class=\"container\">\n      <table class=\"tinytable\" id=\"tinytable_d4jmi219ryng9omcqgo8\" style=\"width: auto; margin-left: auto; margin-right: auto;\" data-quarto-disable-processing='true'>\n        \n        <thead>\n              <tr>\n                <th scope=\"col\" data-row=\"0\" data-col=\"1\"> </th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"2\">No controls</th>\n                <th scope=\"col\" data-row=\"0\" data-col=\"3\">Control for democracy</th>\n              </tr>\n        </thead>\n        <tfoot><tr><td colspan='3'>+ p < 0.1, * p < 0.05, ** p < 0.01, *** p < 0.001</td></tr></tfoot>\n        <tbody>\n                <tr>\n                  <td data-row=\"1\" data-col=\"1\">(Intercept)</td>\n                  <td data-row=\"1\" data-col=\"2\">-0.977***</td>\n                  <td data-row=\"1\" data-col=\"3\">-0.136</td>\n                </tr>\n                <tr>\n                  <td data-row=\"2\" data-col=\"1\"></td>\n                  <td data-row=\"2\" data-col=\"2\">(0.279)</td>\n                  <td data-row=\"2\" data-col=\"3\">(0.338)</td>\n                </tr>\n                <tr>\n                  <td data-row=\"3\" data-col=\"1\">press_freedom</td>\n                  <td data-row=\"3\" data-col=\"2\">1.031***</td>\n                  <td data-row=\"3\" data-col=\"3\">0.506***</td>\n                </tr>\n                <tr>\n                  <td data-row=\"4\" data-col=\"1\"></td>\n                  <td data-row=\"4\" data-col=\"2\">(0.059)</td>\n                  <td data-row=\"4\" data-col=\"3\">(0.137)</td>\n                </tr>\n                <tr>\n                  <td data-row=\"5\" data-col=\"1\">democracyDemocracy</td>\n                  <td data-row=\"5\" data-col=\"2\"></td>\n                  <td data-row=\"5\" data-col=\"3\">3.054***</td>\n                </tr>\n                <tr>\n                  <td data-row=\"6\" data-col=\"1\"></td>\n                  <td data-row=\"6\" data-col=\"2\"></td>\n                  <td data-row=\"6\" data-col=\"3\">(0.730)</td>\n                </tr>\n                <tr>\n                  <td data-row=\"7\" data-col=\"1\">Num.Obs.</td>\n                  <td data-row=\"7\" data-col=\"2\">200</td>\n                  <td data-row=\"7\" data-col=\"3\">200</td>\n                </tr>\n        </tbody>\n      </table>\n    </div>\n<!-- hack to avoid NA insertion in last line -->\n```\n\n:::\n:::\n\n\n\nThe naive estimate overstates the effect of press freedom because it's picking up the effect of democracy. The controlled estimate is closer to the truth ($\\beta = 0.5$) — but the standard error is much larger. This is multicollinearity at work.\n\n\n## What's happening: the stratification view\n\n\nAs we saw in the [controls post](what-are-controls.qmd), controlling for democracy is equivalent to estimating the press freedom-FDI relationship *within* each regime type and taking a weighted average. Let's look at those within-group estimates:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndf |>\n  group_by(democracy) |>\n  summarise(\n    beta = coef(lm(fdi ~ press_freedom))[2],\n    se = summary(lm(fdi ~ press_freedom))$coefficients[2, 2],\n    n = n(),\n    var_x = var(press_freedom),\n    weight = (n() - 1) * var(press_freedom)\n  ) |>\n  my_kbl(caption = \"Within-group estimates\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped table-hover\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Within-group estimates</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:center;\"> democracy </th>\n   <th style=\"text-align:center;\"> beta </th>\n   <th style=\"text-align:center;\"> se </th>\n   <th style=\"text-align:center;\"> n </th>\n   <th style=\"text-align:center;\"> var_x </th>\n   <th style=\"text-align:center;\"> weight </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:center;\"> Autocracy </td>\n   <td style=\"text-align:center;\"> 0.71 </td>\n   <td style=\"text-align:center;\"> 0.38 </td>\n   <td style=\"text-align:center;\"> 108 </td>\n   <td style=\"text-align:center;\"> 0.27 </td>\n   <td style=\"text-align:center;\"> 28.92 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:center;\"> Democracy </td>\n   <td style=\"text-align:center;\"> 0.48 </td>\n   <td style=\"text-align:center;\"> 0.15 </td>\n   <td style=\"text-align:center;\"> 92 </td>\n   <td style=\"text-align:center;\"> 2.14 </td>\n   <td style=\"text-align:center;\"> 194.57 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nThe autocracy group has much less variation in press freedom, so it gets less weight. But more importantly, the within-autocracy estimate has a huge standard error because there's so little variation in $X$ to work with. The overall controlled estimate is being driven almost entirely by the democracy subsample.\n\nThis is the Wooldridge point. The \"problem\" isn't that the regression is doing something wrong. OLS is unbiased. The problem is that the data doesn't give us enough within-group variation to estimate the effect precisely. That's a property of the world — autocracies really do have uniformly low press freedom — not a flaw in the method.\n\n\n## Simulation: imprecision, not bias\n\n\nTo make this concrete, let's run the same data-generating process many times and look at the *sampling distribution* of the controlled estimate:\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsimulate_once <- function(n = 200) {\n  democracy <- rbinom(n, 1, 0.4)\n  press_freedom <- case_when(\n    democracy == 1 ~ rnorm(n, mean = 7, sd = 1.5),\n    democracy == 0 ~ rnorm(n, mean = 2, sd = 0.5)\n  )\n  fdi <- 0.5 * press_freedom + 3 * democracy + rnorm(n, sd = 2)\n  d <- tibble(democracy, press_freedom, fdi)\n\n  mod <- lm(fdi ~ press_freedom + democracy, data = d)\n  coef(mod)[\"press_freedom\"]\n}\n\nsims <- tibble(beta_hat = map_dbl(1:1000, ~simulate_once()))\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](multicollinearity-draft_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\nThe distribution is centered on the truth. OLS is unbiased. But the distribution is wide — in any given sample, the estimate could be quite far from 0.5. This is what imprecision looks like.\n\n\n## The \"cure\" is worse than the disease\n\n\nNow, what do some textbooks recommend? Drop the collinear variable. Let's see what happens if we drop the democracy control:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsims_no_control <- tibble(\n  beta_hat = map_dbl(1:1000, function(i) {\n    democracy <- rbinom(200, 1, 0.4)\n    press_freedom <- case_when(\n      democracy == 1 ~ rnorm(200, mean = 7, sd = 1.5),\n      democracy == 0 ~ rnorm(200, mean = 2, sd = 0.5)\n    )\n    fdi <- 0.5 * press_freedom + 3 * democracy + rnorm(200, sd = 2)\n    coef(lm(fdi ~ press_freedom))[\"press_freedom\"]\n  })\n)\n```\n:::\n\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](multicollinearity-draft_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=90%}\n:::\n:::\n\n\n\nThe uncontrolled estimates are more precise — the distribution is tighter. But they are *biased*: the distribution is centered well above 0.5 because the regression attributes some of democracy's effect on FDI to press freedom. This is the classic bias-variance tradeoff, and in a causal inference setting, bias is usually the bigger concern. An imprecise but unbiased estimate is honest about what the data can tell you. A precise but biased estimate is confidently wrong.\n\nThis is why Wooldridge's framing matters. If you think of multicollinearity as a disease with a \"cure\" (dropping variables), you are trading a cosmetic problem (wide confidence intervals) for a substantive one (omitted variable bias). The right response to multicollinearity is usually to do nothing — or to get more data.\n\n\n## Summary\n\n\nMulticollinearity means your regressors are correlated. When you control for a variable that is highly correlated with your treatment, you're left with little variation to estimate the treatment effect. Your estimates will be imprecise. This is annoying but it's not a methodological failure. It's the data telling you that it can't cleanly distinguish the effects of two things that move together.\n\nThe standard errors are already telling you everything you need to know. There is no additional diagnostic needed. And \"solutions\" that involve dropping confounders to reduce collinearity are almost always worse than the disease.\n\nAs Blanchard put it: multicollinearity is God's will, not a problem with OLS.\n",
    "supporting": [
      "multicollinearity-draft_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}