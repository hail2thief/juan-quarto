{
  "hash": "5ed3896e1e3c370841fac58c65f17189",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Untitled\"\nformat: html\n---\n\n\n\n\n## Introduction\n\n\nWhen I first learned regression, we would look at a model like this: \n\n$$Income_i = \\beta_1 \\times Education_i + \\epsilon_i$$\n\n \nWe'd then say that for every additional year of Education, Income would be expected to increase by $\\beta_1$. We'd then add a control for Age:\n\n$$Income_i = \\beta_1 \\times Education_i + \\beta_2 \\times Age_i + \\epsilon_i$$\n\nAnd then something mysterious would happen. We would now say that for every additional year of Education, Income would be expected to increase by $\\beta_1$, *controlling for Age*. What did this mean, \"controlling for age\"? Other, no less mysterious versions of this phrase include \"adjusting for age\", or \"holding age constant\". \n\nSome textbooks would discuss controlling for age in terms of comparisons. Here's Gelman in *Regression and other stories*:\n\n> > We interpret the regression slopes as comparisons of individuals that differ in one predictor while being at the same levels of the other predictors.\n\nOr from *The Effect*:\n\n> If two observations have the same values of the other variables in the model, but one has a value ofğ‘‹ that is one unit higher, the observation with the X one unit higher will on average have ağ‘Œthat is B1 units higher\n\n\nThis was much more intuitive to me. In our case, we'd say that *comparing two people of identical age*, we'd expect someone with an additional year of education to have $\\beta_1$ more in earnings. \n\n\nBut how is regression *doing this*? What about the regression makes this comparison possible? \n\n\nHere are two ways of thinking about this that clarified regression *controls*, and what they can and can't tell us. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nWarning: package 'ggplot2' was built under R version 4.2.3\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nâ”€â”€ Attaching core tidyverse packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 2.0.0 â”€â”€\nâœ” dplyr     1.1.2     âœ” readr     2.1.4\nâœ” forcats   1.0.0     âœ” stringr   1.5.0\nâœ” ggplot2   3.5.0     âœ” tibble    3.2.1\nâœ” lubridate 1.9.2     âœ” tidyr     1.3.0\nâœ” purrr     1.0.2     \nâ”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€\nâœ– dplyr::filter() masks stats::filter()\nâœ– dplyr::lag()    masks stats::lag()\nâ„¹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n:::\n\n\n\nLet's look at some survey data, a sample of the GSS from `socviz`:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(socviz)\ngss_sm |> \n  select(id, year, obama, childs, age)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2,867 Ã— 5\n      id  year obama childs   age\n   <dbl> <dbl> <dbl>  <dbl> <dbl>\n 1     1  2016     0      3    47\n 2     2  2016     1      0    61\n 3     3  2016     0      2    72\n 4     4  2016     0      4    43\n 5     5  2016     1      2    55\n 6     6  2016     1      2    53\n 7     7  2016    NA      2    50\n 8     8  2016    NA      3    23\n 9     9  2016    NA      3    45\n10    10  2016     0      4    71\n# â„¹ 2,857 more rows\n```\n\n\n:::\n:::\n\n\n\n## \"What's left over\"\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmod1 = lm(childs ~ age, data = gss_sm)\nmodelsummary::modelsummary(mod1)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:center;\"> Â (1) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:center;\"> 0.153 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\">  </td>\n   <td style=\"text-align:center;\"> (0.086) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> age </td>\n   <td style=\"text-align:center;\"> 0.035 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;box-shadow: 0px 1.5px\">  </td>\n   <td style=\"text-align:center;box-shadow: 0px 1.5px\"> (0.002) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Num.Obs. </td>\n   <td style=\"text-align:center;\"> 2849 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 </td>\n   <td style=\"text-align:center;\"> 0.135 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> R2 Adj. </td>\n   <td style=\"text-align:center;\"> 0.134 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> AIC </td>\n   <td style=\"text-align:center;\"> 10593.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> BIC </td>\n   <td style=\"text-align:center;\"> 10611.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Log.Lik. </td>\n   <td style=\"text-align:center;\"> âˆ’5293.751 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:center;\"> 442.679 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> RMSE </td>\n   <td style=\"text-align:center;\"> 1.55 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nLet's look at the residuals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\naugmented_data = broom::augment(mod1) \n\naugmented_data |> \n  select(.rownames, childs, age, .fitted, .resid) |> \n  sample_n(5) |> \n  kableExtra::kable(digits = 2)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> .rownames </th>\n   <th style=\"text-align:right;\"> childs </th>\n   <th style=\"text-align:right;\"> age </th>\n   <th style=\"text-align:right;\"> .fitted </th>\n   <th style=\"text-align:right;\"> .resid </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 358 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 60 </td>\n   <td style=\"text-align:right;\"> 2.23 </td>\n   <td style=\"text-align:right;\"> -2.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1100 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 2.09 </td>\n   <td style=\"text-align:right;\"> -0.09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2724 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> 2.12 </td>\n   <td style=\"text-align:right;\"> -1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1739 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 69 </td>\n   <td style=\"text-align:right;\"> 2.54 </td>\n   <td style=\"text-align:right;\"> -1.54 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2330 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 79 </td>\n   <td style=\"text-align:right;\"> 2.88 </td>\n   <td style=\"text-align:right;\"> 0.12 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod2 = lm(obama ~ age, data = gss_sm)\nmod2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = obama ~ age, data = gss_sm)\n\nCoefficients:\n(Intercept)          age  \n    0.80149     -0.00328  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbroom::augment(mod2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1,728 Ã— 9\n   .rownames obama   age .fitted .resid     .hat .sigma  .cooksd .std.resid\n   <chr>     <dbl> <dbl>   <dbl>  <dbl>    <dbl>  <dbl>    <dbl>      <dbl>\n 1 1             0    47   0.647 -0.647 0.000676  0.481 0.000612     -1.35 \n 2 2             1    61   0.601  0.399 0.000687  0.481 0.000236      0.828\n 3 3             0    72   0.565 -0.565 0.00127   0.481 0.000878     -1.18 \n 4 4             0    43   0.660 -0.660 0.000823  0.481 0.000776     -1.37 \n 5 5             1    55   0.621  0.379 0.000582  0.481 0.000180      0.787\n 6 6             1    53   0.628  0.372 0.000580  0.481 0.000174      0.774\n 7 10            0    71   0.569 -0.569 0.00120   0.481 0.000837     -1.18 \n 8 13            1    32   0.697  0.303 0.00157   0.481 0.000314      0.631\n 9 14            1    60   0.605  0.395 0.000659  0.481 0.000222      0.822\n10 15            0    76   0.552 -0.552 0.00161   0.481 0.00106      -1.15 \n# â„¹ 1,718 more rows\n```\n\n\n:::\n:::\n",
    "supporting": [
      "what-are-controls_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}